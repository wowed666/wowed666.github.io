---
layout: post
title: Blog Post 2 Spectral Clustering
---



In this post I will be guiding you through the process of creating a simple spectral clustering algorithm.
Spectral clustering allows us to find similarities in data points.
In this simple tutorial, we will understand how to partition data into their natural clusters.


## Introduction

In this part we'll study *spectral clustering*. Spectral clustering is an important tool for identifying meaningful
parts of data sets with complex structure. To start, let's look at an example where we *don't* need spectral clustering. 

 
Firstly let's import the package that we'll need!

```python


import numpy as np
from sklearn import datasets
from matplotlib import pyplot as plt


```

```python
n = 200
np.random.seed(1111)
X, y = datasets.make_blobs(n_samples=n, shuffle=True, random_state=None, centers = 2, cluster_std = 2.0)
plt.scatter(X[:,0], X[:,1])


```
![HW2_1.png](/images/Blog2/HW2_1.png)

```python
from sklearn.cluster import KMeans
km = KMeans(n_clusters = 2)
km.fit(X)

plt.scatter(X[:,0], X[:,1], c = km.predict(X))
```
![HW2_2.png](/images/Blog2/HW2_2.png)

## Harder Clustering
That was all well and good, but what if our data is "shaped weird"?

```python
np.random.seed(1234)
n = 200
X, y = datasets.make_moons(n_samples=n, shuffle=True, noise=0.05, random_state=None)
plt.scatter(X[:,0], X[:,1])
```
![HW2_3.png](/images/Blog2/HW2_3.png)
We can still make out two meaningful clusters in the data, but now they aren't blobs but crescents. 
As before, the Euclidean coordinates of the data points are contained in the matrix X, while the labels of each point are contained in y. 
Now k-means won't work so well, because k-means is, by design, looking for circular clusters.

```python
km = KMeans(n_clusters = 2)
km.fit(X)
plt.scatter(X[:,0], X[:,1], c = km.predict(X))

```
![HW2_4.png](/images/Blog2/HW2_4.png)

Whoops! That's not right!

As we'll see, spectral clustering is able to correctly cluster the two crescents. In the following problems, you will derive and implement spectral clustering.

## Part A
First, we begin by creating a similariy matrix of shape (n,n) that contains the distances between each pair of coordinates in the matrix. The library sklearn has a function we can use!

When constructing the similarity matrix, use a parameter epsilon. Entry A[i,j] should be equal to 1 if X[i] (the coordinates of data point i) is within distance epsilon of X[j] (the coordinates of data point j).

The diagonal entries A[i,i] should all be equal to zero.

```python
from sklearn.metrics.pairwise import euclidean_distances
epsilon = 0.4

# pairwise distance matrix of X
D = euclidean_distances(X)

# if distance smaller than epsilon, fill 1, otherwise 0 
A = 1*(D< epsilon*np.ones(shape=(n,n)))

# update the diagonal entries to be 0
np.fill_diagonal(A,0)
A
```
<div class="output_subarea output_text output_result" dir="auto"><pre>array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 1, 0],
       ...,
       [0, 0, 0, ..., 0, 1, 1],
       [0, 0, 1, ..., 1, 0, 1],
       [0, 0, 0, ..., 1, 1, 0]])</pre></div>

<div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><h2 id="Part-B">Part B<a class="anchor-link" href="#Part-B">¶</a></h2>
<p>The matrix <code>A</code> now contains information about which points are near (within distance <code>epsilon</code>) which other points. We now pose the task of clustering the data points in <code>X</code> as the task of partitioning the rows and columns of <code>A</code>. </p>
<p>Let <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-37" style="width: 6.546em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.465em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.564em, 1005.47em, 3.124em, -999.997em); top: -2.518em; left: 0em;"><span class="mrow" id="MathJax-Span-38"><span class="msubsup" id="MathJax-Span-39"><span style="display: inline-block; position: relative; width: 0.843em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.54em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-40" style="font-family: STIXMathJax_Normal-italic;">𝑑</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.543em;"><span class="mi" id="MathJax-Span-41" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-42" style="font-family: STIXMathJax_Main; padding-left: 0.303em;">=</span><span class="munderover" id="MathJax-Span-43" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 2.104em; height: 0px;"><span style="position: absolute; clip: rect(3.064em, 1000.84em, 4.445em, -999.997em); top: -4.019em; left: 0em;"><span class="mo" id="MathJax-Span-44" style="font-family: STIXMathJax_Operators; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; clip: rect(3.544em, 1000.42em, 4.205em, -999.997em); top: -4.499em; left: 0.903em;"><span class="mi" id="MathJax-Span-45" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑛</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; clip: rect(3.364em, 1001.2em, 4.325em, -999.997em); top: -3.718em; left: 0.903em;"><span class="texatom" id="MathJax-Span-46"><span class="mrow" id="MathJax-Span-47"><span class="mi" id="MathJax-Span-48" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑗</span><span class="mo" id="MathJax-Span-49" style="font-size: 70.7%; font-family: STIXMathJax_Main;">=</span><span class="mn" id="MathJax-Span-50" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-51" style="padding-left: 0.183em;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.424em, 1000.48em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-52" style="font-family: STIXMathJax_Normal-italic;">𝑎</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.483em;"><span class="texatom" id="MathJax-Span-53"><span class="mrow" id="MathJax-Span-54"><span class="mi" id="MathJax-Span-55" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑖</span><span class="mi" id="MathJax-Span-56" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑗</span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.524em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-7">d_i = \sum_{j = 1}^n a_{ij}</script> be the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-57" style="width: 0.363em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.303em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.564em, 1000.24em, 2.524em, -999.997em); top: -2.338em; left: 0em;"><span class="mrow" id="MathJax-Span-58"><span class="mi" id="MathJax-Span-59" style="font-family: STIXMathJax_Normal-italic;">𝑖</span></span><span style="display: inline-block; width: 0px; height: 2.344em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">i</script>th row-sum of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>A</mi></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-60" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.723em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.744em, 1000.66em, 2.764em, -999.997em); top: -2.578em; left: 0em;"><span class="mrow" id="MathJax-Span-61"><span class="texatom" id="MathJax-Span-62"><span class="mrow" id="MathJax-Span-63"><span class="mi" id="MathJax-Span-64" style="font-family: STIXMathJax_Normal-bold;">𝐀</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.584em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">A</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-9">\mathbf{A}</script>, which is also called the <em>degree</em> of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-65" style="width: 0.363em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.303em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.564em, 1000.24em, 2.524em, -999.997em); top: -2.338em; left: 0em;"><span class="mrow" id="MathJax-Span-66"><span class="mi" id="MathJax-Span-67" style="font-family: STIXMathJax_Normal-italic;">𝑖</span></span><span style="display: inline-block; width: 0px; height: 2.344em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">i</script>. Let <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mn>0</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-68" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.384em, 1001.08em, 2.584em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-69"><span class="msubsup" id="MathJax-Span-70"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-71" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-72" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-11">C_0</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-73" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.384em, 1001.08em, 2.524em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-74"><span class="msubsup" id="MathJax-Span-75"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-76" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-77" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-12">C_1</script> be two clusters of the data points. We assume that every data point is in either <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mn>0</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-78" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.384em, 1001.08em, 2.584em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-79"><span class="msubsup" id="MathJax-Span-80"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-81" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-82" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-13">C_0</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-83" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.384em, 1001.08em, 2.524em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-84"><span class="msubsup" id="MathJax-Span-85"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-86" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-87" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-14">C_1</script>. The cluster membership as being specified by <code>y</code>. We think of <code>y[i]</code> as being the label of point <code>i</code>. So, if <code>y[i] = 1</code>, then point <code>i</code> (and therefore row <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-88" style="width: 0.363em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.303em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.564em, 1000.24em, 2.524em, -999.997em); top: -2.338em; left: 0em;"><span class="mrow" id="MathJax-Span-89"><span class="mi" id="MathJax-Span-90" style="font-family: STIXMathJax_Normal-italic;">𝑖</span></span><span style="display: inline-block; width: 0px; height: 2.344em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">i</script> of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>A</mi></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-91" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.723em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.744em, 1000.66em, 2.764em, -999.997em); top: -2.578em; left: 0em;"><span class="mrow" id="MathJax-Span-92"><span class="texatom" id="MathJax-Span-93"><span class="mrow" id="MathJax-Span-94"><span class="mi" id="MathJax-Span-95" style="font-family: STIXMathJax_Normal-bold;">𝐀</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.584em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">A</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-16">\mathbf{A}</script>) is an element of cluster <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-96" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.384em, 1001.08em, 2.524em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-97"><span class="msubsup" id="MathJax-Span-98"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-99" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-100" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-17">C_1</script>.  </p>
<p>The <em>binary norm cut objective</em> of a matrix <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>A</mi></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-101" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.723em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.744em, 1000.66em, 2.764em, -999.997em); top: -2.578em; left: 0em;"><span class="mrow" id="MathJax-Span-102"><span class="texatom" id="MathJax-Span-103"><span class="mrow" id="MathJax-Span-104"><span class="mi" id="MathJax-Span-105" style="font-family: STIXMathJax_Normal-bold;">𝐀</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.584em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">A</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-18">\mathbf{A}</script> is the function </p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>N</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>A</mi></mrow></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>C</mi><mn>0</mn></msub><mo>,</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2261;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>c</mi><mi mathvariant=&quot;bold&quot;>u</mi><mi mathvariant=&quot;bold&quot;>t</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>C</mi><mn>0</mn></msub><mo>,</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mrow><mo>(</mo><mfrac><mn>1</mn><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi><mi mathvariant=&quot;bold&quot;>o</mi><mi mathvariant=&quot;bold&quot;>l</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>C</mi><mn>0</mn></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi><mi mathvariant=&quot;bold&quot;>o</mi><mi mathvariant=&quot;bold&quot;>l</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo>)</mo></mrow><mspace width=&quot;thickmathspace&quot; /><mo>.</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-106" style="width: 25.033em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.011em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(2.404em, 1020.95em, 5.225em, -999.997em); top: -4.079em; left: 0em;"><span class="mrow" id="MathJax-Span-107"><span class="msubsup" id="MathJax-Span-108"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.9em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-109" style="font-family: STIXMathJax_Normal-italic;">𝑁<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.843em;"><span class="texatom" id="MathJax-Span-110"><span class="mrow" id="MathJax-Span-111"><span class="texatom" id="MathJax-Span-112"><span class="mrow" id="MathJax-Span-113"><span class="mi" id="MathJax-Span-114" style="font-size: 70.7%; font-family: STIXMathJax_Normal-bold;">𝐀</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-115" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-116"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-117" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-118" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-119" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-120" style="padding-left: 0.183em;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-121" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-122" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-123" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-124" style="font-family: STIXMathJax_Main; padding-left: 0.303em;">≡</span><span class="texatom" id="MathJax-Span-125" style="padding-left: 0.303em;"><span class="mrow" id="MathJax-Span-126"><span class="mi" id="MathJax-Span-127" style="font-family: STIXMathJax_Normal-bold;">𝐜</span><span class="mi" id="MathJax-Span-128" style="font-family: STIXMathJax_Normal-bold;">𝐮</span><span class="mi" id="MathJax-Span-129" style="font-family: STIXMathJax_Normal-bold;">𝐭</span></span></span><span class="mo" id="MathJax-Span-130" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-131"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-132" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-133" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-134" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-135" style="padding-left: 0.183em;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-136" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-137" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-138" style="font-family: STIXMathJax_Main;">)</span><span class="mrow" id="MathJax-Span-139" style="padding-left: 0.183em;"><span class="mo" id="MathJax-Span-140" style="vertical-align: -0.597em;"><span style="font-family: STIXMathJax_Size3;">(</span></span><span class="mfrac" id="MathJax-Span-141"><span style="display: inline-block; position: relative; width: 3.184em; height: 0px; margin-right: 0.123em; margin-left: 0.123em;"><span style="position: absolute; clip: rect(3.184em, 1000.42em, 4.205em, -999.997em); top: -4.679em; left: 50%; margin-left: -0.237em;"><span class="mn" id="MathJax-Span-142" style="font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; clip: rect(3.184em, 1003em, 4.385em, -999.997em); top: -3.358em; left: 50%; margin-left: -1.498em;"><span class="mrow" id="MathJax-Span-143"><span class="texatom" id="MathJax-Span-144"><span class="mrow" id="MathJax-Span-145"><span class="mi" id="MathJax-Span-146" style="font-family: STIXMathJax_Normal-bold;">𝐯</span><span class="mi" id="MathJax-Span-147" style="font-family: STIXMathJax_Normal-bold;">𝐨</span><span class="mi" id="MathJax-Span-148" style="font-family: STIXMathJax_Normal-bold;">𝐥</span></span></span><span class="mo" id="MathJax-Span-149" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-150"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-151" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-152" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-153" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; clip: rect(0.843em, 1003.18em, 1.264em, -999.997em); top: -1.318em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.184em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.083em;"></span></span></span></span><span class="mo" id="MathJax-Span-154" style="font-family: STIXMathJax_Main; padding-left: 0.243em;">+</span><span class="mfrac" id="MathJax-Span-155" style="padding-left: 0.243em;"><span style="display: inline-block; position: relative; width: 3.184em; height: 0px; margin-right: 0.123em; margin-left: 0.123em;"><span style="position: absolute; clip: rect(3.184em, 1000.42em, 4.205em, -999.997em); top: -4.679em; left: 50%; margin-left: -0.237em;"><span class="mn" id="MathJax-Span-156" style="font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; clip: rect(3.184em, 1003em, 4.385em, -999.997em); top: -3.358em; left: 50%; margin-left: -1.498em;"><span class="mrow" id="MathJax-Span-157"><span class="texatom" id="MathJax-Span-158"><span class="mrow" id="MathJax-Span-159"><span class="mi" id="MathJax-Span-160" style="font-family: STIXMathJax_Normal-bold;">𝐯</span><span class="mi" id="MathJax-Span-161" style="font-family: STIXMathJax_Normal-bold;">𝐨</span><span class="mi" id="MathJax-Span-162" style="font-family: STIXMathJax_Normal-bold;">𝐥</span></span></span><span class="mo" id="MathJax-Span-163" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-164"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-165" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-166" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-167" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; clip: rect(0.843em, 1003.18em, 1.264em, -999.997em); top: -1.318em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.184em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.083em;"></span></span></span></span><span class="mo" id="MathJax-Span-168" style="vertical-align: -0.597em;"><span style="font-family: STIXMathJax_Size3;">)</span></span></span><span class="mspace" id="MathJax-Span-169" style="height: 0em; vertical-align: 0em; width: 0.303em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-170" style="font-family: STIXMathJax_Main; padding-left: 0.183em;">.</span></span><span style="display: inline-block; width: 0px; height: 4.085em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.211em; border-left: 0px solid; width: 0px; height: 3.075em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>N</mi><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">A</mi></mrow></mrow></msub><mo stretchy="false">(</mo><msub><mi>C</mi><mn>0</mn></msub><mo>,</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>≡</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi><mi mathvariant="bold">u</mi><mi mathvariant="bold">t</mi></mrow><mo stretchy="false">(</mo><msub><mi>C</mi><mn>0</mn></msub><mo>,</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mrow><mo>(</mo><mfrac><mn>1</mn><mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">l</mi></mrow><mo stretchy="false">(</mo><msub><mi>C</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">l</mi></mrow><mo stretchy="false">(</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>)</mo></mrow><mspace width="thickmathspace"></mspace><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-19">N_{\mathbf{A}}(C_0, C_1)\equiv \mathbf{cut}(C_0, C_1)\left(\frac{1}{\mathbf{vol}(C_0)} + \frac{1}{\mathbf{vol}(C_1)}\right)\;.</script></p>
<p>In this expression, </p>
<ul>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>c</mi><mi mathvariant=&quot;bold&quot;>u</mi><mi mathvariant=&quot;bold&quot;>t</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>C</mi><mn>0</mn></msub><mo>,</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2261;</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2208;</mo><msub><mi>C</mi><mn>0</mn></msub><mo>,</mo><mi>j</mi><mo>&amp;#x2208;</mo><msub><mi>C</mi><mn>1</mn></msub></mrow></munder><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-171" style="width: 13.508em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.348em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.624em, 1011.35em, 3.184em, -999.997em); top: -2.578em; left: 0em;"><span class="mrow" id="MathJax-Span-172"><span class="texatom" id="MathJax-Span-173"><span class="mrow" id="MathJax-Span-174"><span class="mi" id="MathJax-Span-175" style="font-family: STIXMathJax_Normal-bold;">𝐜</span><span class="mi" id="MathJax-Span-176" style="font-family: STIXMathJax_Normal-bold;">𝐮</span><span class="mi" id="MathJax-Span-177" style="font-family: STIXMathJax_Normal-bold;">𝐭</span></span></span><span class="mo" id="MathJax-Span-178" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-179"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-180" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-181" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-182" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-183" style="padding-left: 0.183em;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-184" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-185" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-186" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-187" style="font-family: STIXMathJax_Main; padding-left: 0.303em;">≡</span><span class="munderover" id="MathJax-Span-188" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 4.205em; height: 0px;"><span style="position: absolute; clip: rect(3.064em, 1000.84em, 4.445em, -999.997em); top: -4.019em; left: 0em;"><span class="mo" id="MathJax-Span-189" style="font-family: STIXMathJax_Operators; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.718em; left: 0.903em;"><span class="texatom" id="MathJax-Span-190"><span class="mrow" id="MathJax-Span-191"><span class="mi" id="MathJax-Span-192" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑖</span><span class="mo" id="MathJax-Span-193" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∈</span><span class="msubsup" id="MathJax-Span-194"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px;"><span style="position: absolute; clip: rect(3.364em, 1000.48em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-195" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.483em;"><span class="mn" id="MathJax-Span-196" style="font-size: 50%; font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-197" style="font-size: 70.7%; font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-198" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑗</span><span class="mo" id="MathJax-Span-199" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∈</span><span class="msubsup" id="MathJax-Span-200"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px;"><span style="position: absolute; clip: rect(3.364em, 1000.48em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-201" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.483em;"><span class="mn" id="MathJax-Span-202" style="font-size: 50%; font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-203" style="padding-left: 0.183em;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.424em, 1000.48em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-204" style="font-family: STIXMathJax_Normal-italic;">𝑎</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.483em;"><span class="texatom" id="MathJax-Span-205"><span class="mrow" id="MathJax-Span-206"><span class="mi" id="MathJax-Span-207" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑖</span><span class="mi" id="MathJax-Span-208" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑗</span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.584em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi><mi mathvariant="bold">u</mi><mi mathvariant="bold">t</mi></mrow><mo stretchy="false">(</mo><msub><mi>C</mi><mn>0</mn></msub><mo>,</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>≡</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>∈</mo><msub><mi>C</mi><mn>0</mn></msub><mo>,</mo><mi>j</mi><mo>∈</mo><msub><mi>C</mi><mn>1</mn></msub></mrow></munder><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-20">\mathbf{cut}(C_0, C_1) \equiv \sum_{i \in C_0, j \in C_1} a_{ij}</script> is the <em>cut</em> of the clusters <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mn>0</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-209" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.384em, 1001.08em, 2.584em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-210"><span class="msubsup" id="MathJax-Span-211"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-212" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-213" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-21">C_0</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-214" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.384em, 1001.08em, 2.524em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-215"><span class="msubsup" id="MathJax-Span-216"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-217" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-218" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-22">C_1</script>. </li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi><mi mathvariant=&quot;bold&quot;>o</mi><mi mathvariant=&quot;bold&quot;>l</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>C</mi><mn>0</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2261;</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2208;</mo><msub><mi>C</mi><mn>0</mn></msub></mrow></munder><msub><mi>d</mi><mi>i</mi></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-219" style="width: 9.307em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.806em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.624em, 1007.81em, 3.184em, -999.997em); top: -2.578em; left: 0em;"><span class="mrow" id="MathJax-Span-220"><span class="texatom" id="MathJax-Span-221"><span class="mrow" id="MathJax-Span-222"><span class="mi" id="MathJax-Span-223" style="font-family: STIXMathJax_Normal-bold;">𝐯</span><span class="mi" id="MathJax-Span-224" style="font-family: STIXMathJax_Normal-bold;">𝐨</span><span class="mi" id="MathJax-Span-225" style="font-family: STIXMathJax_Normal-bold;">𝐥</span></span></span><span class="mo" id="MathJax-Span-226" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-227"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-228" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-229" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-230" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-231" style="font-family: STIXMathJax_Main; padding-left: 0.303em;">≡</span><span class="munderover" id="MathJax-Span-232" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 2.464em; height: 0px;"><span style="position: absolute; clip: rect(3.064em, 1000.84em, 4.445em, -999.997em); top: -4.019em; left: 0em;"><span class="mo" id="MathJax-Span-233" style="font-family: STIXMathJax_Operators; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.718em; left: 0.903em;"><span class="texatom" id="MathJax-Span-234"><span class="mrow" id="MathJax-Span-235"><span class="mi" id="MathJax-Span-236" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑖</span><span class="mo" id="MathJax-Span-237" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∈</span><span class="msubsup" id="MathJax-Span-238"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px;"><span style="position: absolute; clip: rect(3.364em, 1000.48em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-239" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.483em;"><span class="mn" id="MathJax-Span-240" style="font-size: 50%; font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-241" style="padding-left: 0.183em;"><span style="display: inline-block; position: relative; width: 0.843em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.54em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-242" style="font-family: STIXMathJax_Normal-italic;">𝑑</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.543em;"><span class="mi" id="MathJax-Span-243" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.584em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">l</mi></mrow><mo stretchy="false">(</mo><msub><mi>C</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>≡</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>∈</mo><msub><mi>C</mi><mn>0</mn></msub></mrow></munder><msub><mi>d</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-23">\mathbf{vol}(C_0) \equiv \sum_{i \in C_0}d_i</script>, where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-244" style="width: 6.546em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.465em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.564em, 1005.47em, 3.124em, -999.997em); top: -2.518em; left: 0em;"><span class="mrow" id="MathJax-Span-245"><span class="msubsup" id="MathJax-Span-246"><span style="display: inline-block; position: relative; width: 0.843em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.54em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-247" style="font-family: STIXMathJax_Normal-italic;">𝑑</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.543em;"><span class="mi" id="MathJax-Span-248" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-249" style="font-family: STIXMathJax_Main; padding-left: 0.303em;">=</span><span class="munderover" id="MathJax-Span-250" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 2.104em; height: 0px;"><span style="position: absolute; clip: rect(3.064em, 1000.84em, 4.445em, -999.997em); top: -4.019em; left: 0em;"><span class="mo" id="MathJax-Span-251" style="font-family: STIXMathJax_Operators; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; clip: rect(3.544em, 1000.42em, 4.205em, -999.997em); top: -4.499em; left: 0.903em;"><span class="mi" id="MathJax-Span-252" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑛</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; clip: rect(3.364em, 1001.2em, 4.325em, -999.997em); top: -3.718em; left: 0.903em;"><span class="texatom" id="MathJax-Span-253"><span class="mrow" id="MathJax-Span-254"><span class="mi" id="MathJax-Span-255" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑗</span><span class="mo" id="MathJax-Span-256" style="font-size: 70.7%; font-family: STIXMathJax_Main;">=</span><span class="mn" id="MathJax-Span-257" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-258" style="padding-left: 0.183em;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.424em, 1000.48em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-259" style="font-family: STIXMathJax_Normal-italic;">𝑎</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.483em;"><span class="texatom" id="MathJax-Span-260"><span class="mrow" id="MathJax-Span-261"><span class="mi" id="MathJax-Span-262" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑖</span><span class="mi" id="MathJax-Span-263" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑗</span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.524em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">d_i = \sum_{j = 1}^n a_{ij}</script> is the <em>degree</em> of row <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-264" style="width: 0.363em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.303em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.564em, 1000.24em, 2.524em, -999.997em); top: -2.338em; left: 0em;"><span class="mrow" id="MathJax-Span-265"><span class="mi" id="MathJax-Span-266" style="font-family: STIXMathJax_Normal-italic;">𝑖</span></span><span style="display: inline-block; width: 0px; height: 2.344em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">i</script> (the total number of all other rows related to row <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-267" style="width: 0.363em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.303em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.564em, 1000.24em, 2.524em, -999.997em); top: -2.338em; left: 0em;"><span class="mrow" id="MathJax-Span-268"><span class="mi" id="MathJax-Span-269" style="font-family: STIXMathJax_Normal-italic;">𝑖</span></span><span style="display: inline-block; width: 0px; height: 2.344em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">i</script> through <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-270" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.723em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.504em, 1000.66em, 2.524em, -999.997em); top: -2.338em; left: 0em;"><span class="mrow" id="MathJax-Span-271"><span class="mi" id="MathJax-Span-272" style="font-family: STIXMathJax_Normal-italic;">𝐴</span></span><span style="display: inline-block; width: 0px; height: 2.344em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">A</script>). The <em>volume</em> of cluster <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mn>0</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-273" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.384em, 1001.08em, 2.584em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-274"><span class="msubsup" id="MathJax-Span-275"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-276" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-277" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-28">C_0</script> is a measure of the size of the cluster. </li>
</ul>
<p>A pair of clusters <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mn>0</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-278" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.384em, 1001.08em, 2.584em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-279"><span class="msubsup" id="MathJax-Span-280"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-281" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-282" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-29">C_0</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-283" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.384em, 1001.08em, 2.524em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-284"><span class="msubsup" id="MathJax-Span-285"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-286" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-287" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-30">C_1</script> is considered to be a "good" partition of the data when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>N</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>A</mi></mrow></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>C</mi><mn>0</mn></msub><mo>,</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-288" style="width: 5.585em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.685em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.684em, 1004.62em, 2.884em, -999.997em); top: -2.518em; left: 0em;"><span class="mrow" id="MathJax-Span-289"><span class="msubsup" id="MathJax-Span-290"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.9em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-291" style="font-family: STIXMathJax_Normal-italic;">𝑁<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.843em;"><span class="texatom" id="MathJax-Span-292"><span class="mrow" id="MathJax-Span-293"><span class="texatom" id="MathJax-Span-294"><span class="mrow" id="MathJax-Span-295"><span class="mi" id="MathJax-Span-296" style="font-size: 70.7%; font-family: STIXMathJax_Normal-bold;">𝐀</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-297" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-298"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-299" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-300" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-301" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-302" style="padding-left: 0.183em;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-303" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-304" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-305" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.524em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">A</mi></mrow></mrow></msub><mo stretchy="false">(</mo><msub><mi>C</mi><mn>0</mn></msub><mo>,</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-31">N_{\mathbf{A}}(C_0, C_1)</script> is small. To see why, let's look at each of the two factors in this objective function separately. </p>
<h4 id="B.1-The-Cut-Term">B.1 The Cut Term<a class="anchor-link" href="#B.1-The-Cut-Term">¶</a></h4>
<p>First, the cut term <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>c</mi><mi mathvariant=&quot;bold&quot;>u</mi><mi mathvariant=&quot;bold&quot;>t</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>C</mi><mn>0</mn></msub><mo>,</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-306" style="width: 5.525em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.625em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.744em, 1004.57em, 2.944em, -999.997em); top: -2.578em; left: 0em;"><span class="mrow" id="MathJax-Span-307"><span class="texatom" id="MathJax-Span-308"><span class="mrow" id="MathJax-Span-309"><span class="mi" id="MathJax-Span-310" style="font-family: STIXMathJax_Normal-bold;">𝐜</span><span class="mi" id="MathJax-Span-311" style="font-family: STIXMathJax_Normal-bold;">𝐮</span><span class="mi" id="MathJax-Span-312" style="font-family: STIXMathJax_Normal-bold;">𝐭</span></span></span><span class="mo" id="MathJax-Span-313" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-314"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-315" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-316" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-317" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-318" style="padding-left: 0.183em;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-319" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-320" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-321" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.584em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi><mi mathvariant="bold">u</mi><mi mathvariant="bold">t</mi></mrow><mo stretchy="false">(</mo><msub><mi>C</mi><mn>0</mn></msub><mo>,</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-32">\mathbf{cut}(C_0, C_1)</script> is the number of nonzero entries in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>A</mi></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-322" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.723em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.744em, 1000.66em, 2.764em, -999.997em); top: -2.578em; left: 0em;"><span class="mrow" id="MathJax-Span-323"><span class="texatom" id="MathJax-Span-324"><span class="mrow" id="MathJax-Span-325"><span class="mi" id="MathJax-Span-326" style="font-family: STIXMathJax_Normal-bold;">𝐀</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.584em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">A</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-33">\mathbf{A}</script> that relate points in cluster <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mn>0</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-327" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.384em, 1001.08em, 2.584em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-328"><span class="msubsup" id="MathJax-Span-329"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-330" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-331" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-34">C_0</script> to points in cluster <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-332" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.384em, 1001.08em, 2.524em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-333"><span class="msubsup" id="MathJax-Span-334"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-335" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-336" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-35">C_1</script>. Saying that this term should be small is the same as saying that points in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mn>0</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-337" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.384em, 1001.08em, 2.584em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-338"><span class="msubsup" id="MathJax-Span-339"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-340" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-341" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-36">C_0</script> shouldn't usually be very close to points in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-342" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.384em, 1001.08em, 2.524em, -999.997em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-343"><span class="msubsup" id="MathJax-Span-344"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-345" style="font-family: STIXMathJax_Normal-italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.663em;"><span class="mn" id="MathJax-Span-346" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.224em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-37">C_1</script>. </p>
</div>

```python

def cut(A,y):
    #this list contains the elements in cluster 0
    C1 = [i for i in range(len(y)) if y[i] == 1]
    #this list contains the elements in cluster 1
    C0 = [i for i in range(len(y)) if y[i] != 1]
    
    sum_cluster = 0
    
    for i in C0:
        for j in C1:
           #Adds the value of the i,j entry to the sum of all entries
            sum_cluster += A[i][j]
    return(sum_cluster)

```
Compute the cut objective for the true clusters y. Then, generate a random vector of random labels of length n, with each label equal to either 0 or 1. Check the cut objective for the random labels. You should find that the cut objective for the true labels is much smaller than the cut objective for the random labels.

This shows that this part of the cut objective indeed favors the true clusters over the random ones.
```python

temp = np.random.randint(2,size = n)
true = cut(A,y)
rand = cut(A,temp)
(true,rand)
```
(13, 1116)


#### B.2 The Volume Term 

Now take a look at the second factor in the norm cut objective. This is the *volume term*. As mentioned above, the *volume* of cluster $C_0$ is a measure of how "big" cluster $C_0$ is. If we choose cluster $C_0$ to be small, then $\mathbf{vol}(C_0)$ will be small and $\frac{1}{\mathbf{vol}(C_0)}$ will be large, leading to an undesirable higher objective value. 

Synthesizing, the binary normcut objective asks us to find clusters $C_0$ and $C_1$ such that:

1. There are relatively few entries of $\mathbf{A}$ that join $C_0$ and $C_1$. 
2. Neither $C_0$ and $C_1$ are too small. 


```python

def vols(A,y):
    v0 = A[y == 0].sum() # row sum for which y == 0
    v1 = A[y == 1].sum() # row sum for which y == 1
    return(v0,v1)

def normcut(A,y):
    (v0,v1) = vols(A,y)
    c = cut(A,y)
    return(c*(1/v0+1/v1))

```
Now, compare the normcut objective using both the true labels y and the fake labels you generated above

```python
(normcut(A,y),normcut(A,temp))

```
(0.011518412331615225, 0.995836336735081)

Compare to true claster  we get a very low value for the binary norm cut objective.


## Part C

We have now defined a normalized cut objective which takes small values when the input clusters are (a) joined by relatively few entries in $A$ and (b) not too small. One approach to clustering is to try to find a cluster vector `y` such that `normcut(A,y)` is small. However, this is an NP-hard combinatorial optimization problem, which means that may not be possible to find the best clustering in practical time, even for relatively small data sets. We need a math trick! 

Here's the trick: define a new vector $\mathbf{z} \in \mathbb{R}^n$ such that: 

$$
z_i = 
\begin{cases}
    \frac{1}{\mathbf{vol}(C_0)} &\quad \text{if } y_i = 0 \\ 
    -\frac{1}{\mathbf{vol}(C_1)} &\quad \text{if } y_i = 1 \\ 
\end{cases}
$$


Note that the signs of  the elements of $\mathbf{z}$ contain all the information from $\mathbf{y}$: if $i$ is in cluster $C_0$, then $y_i = 0$ and $z_i > 0$. 

Next, if you like linear algebra, you can show that 

$$\mathbf{N}_{\mathbf{A}}(C_0, C_1) = 2\frac{\mathbf{z}^T (\mathbf{D} - \mathbf{A})\mathbf{z}}{\mathbf{z}^T\mathbf{D}\mathbf{z}}\;,$$

where $\mathbf{D}$ is the diagonal matrix with nonzero entries $d_{ii} = d_i$, and  where $d_i = \sum_{j = 1}^n a_i$ is the degree (row-sum) from before.  

```python

def transform(A,y):
    v0,v1 = vols(A,y)
    z = 1/v0*(y == 0)-1/v1*(y == 1)
    return(z)
    z = transform(A,y)
    # compute the row sum
    v = A.sum(axis = 1)
    # row sum as the diagonal entries
    D = np.diag(v)
    np.isclose(normcut(A,y),z.T@(D-A)@z/(z.T@D@z))
```
```
True
```

```python
np.isclose(0,z.T@D@np.ones(n))
```
```
True
```

<div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><h2 id="Part-D">Part D<a class="anchor-link" href="#Part-D">¶</a></h2>
<p>In the last part, we saw that the problem of minimizing the normcut objective is mathematically related to the problem of minimizing the function </p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>R</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>A</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2261;</mo><mfrac><mrow><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow><mi>T</mi></msup><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>D</mi></mrow><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>A</mi></mrow><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow></mrow><mrow><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow><mi>T</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>D</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow></mrow></mfrac></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1201" style="width: 10.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.813em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1008.81em, 3.515em, -999.997em); top: -2.616em; left: 0em;"><span class="mrow" id="MathJax-Span-1202"><span class="msubsup" id="MathJax-Span-1203"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-1204" style="font-family: STIXMathJax_Normal-italic;">𝑅</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="texatom" id="MathJax-Span-1205"><span class="mrow" id="MathJax-Span-1206"><span class="mi" id="MathJax-Span-1207" style="font-size: 70.7%; font-family: STIXMathJax_Normal-bold;">𝐀</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1208" style="font-family: STIXMathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1209"><span class="mrow" id="MathJax-Span-1210"><span class="mi" id="MathJax-Span-1211" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span><span class="mo" id="MathJax-Span-1212" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-1213" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">≡</span><span class="mfrac" id="MathJax-Span-1214" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 4.824em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(2.979em, 1004.71em, 4.348em, -999.997em); top: -4.64em; left: 50%; margin-left: -2.378em;"><span class="mrow" id="MathJax-Span-1215"><span class="msubsup" id="MathJax-Span-1216"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-1217"><span class="mrow" id="MathJax-Span-1218"><span class="mi" id="MathJax-Span-1219" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="mi" id="MathJax-Span-1220" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑇<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1221" style="font-family: STIXMathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1222"><span class="mrow" id="MathJax-Span-1223"><span class="mi" id="MathJax-Span-1224" style="font-family: STIXMathJax_Normal-bold;">𝐃</span></span></span><span class="mo" id="MathJax-Span-1225" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-1226" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-1227"><span class="mi" id="MathJax-Span-1228" style="font-family: STIXMathJax_Normal-bold;">𝐀</span></span></span><span class="mo" id="MathJax-Span-1229" style="font-family: STIXMathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1230"><span class="mrow" id="MathJax-Span-1231"><span class="mi" id="MathJax-Span-1232" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.039em, 1002.15em, 4.17em, -999.997em); top: -3.271em; left: 50%; margin-left: -1.068em;"><span class="mrow" id="MathJax-Span-1233"><span class="msubsup" id="MathJax-Span-1234"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-1235"><span class="mrow" id="MathJax-Span-1236"><span class="mi" id="MathJax-Span-1237" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.42em;"><span class="mi" id="MathJax-Span-1238" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑇<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1239"><span class="mrow" id="MathJax-Span-1240"><span class="mi" id="MathJax-Span-1241" style="font-family: STIXMathJax_Normal-bold;">𝐃</span></span></span><span class="texatom" id="MathJax-Span-1242"><span class="mrow" id="MathJax-Span-1243"><span class="mi" id="MathJax-Span-1244" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1004.82em, 1.253em, -999.997em); top: -1.307em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.824em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.622em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.925em; border-left: 0px solid; width: 0px; height: 2.861em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>R</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">A</mi></mrow></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mo stretchy="false">)</mo><mo>≡</mo><mfrac><mrow><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mi>T</mi></msup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">D</mi></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">A</mi></mrow><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow></mrow><mrow><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mi>T</mi></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-106"> R_\mathbf{A}(\mathbf{z})\equiv \frac{\mathbf{z}^T (\mathbf{D} - \mathbf{A})\mathbf{z}}{\mathbf{z}^T\mathbf{D}\mathbf{z}} </script></p>
<p>subject to the condition <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow><mi>T</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>D</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;double-struck&quot;>1</mn></mrow><mo>=</mo><mn>0</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1245" style="width: 4.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.051em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1004.05em, 2.801em, -999.997em); top: -2.616em; left: 0em;"><span class="mrow" id="MathJax-Span-1246"><span class="msubsup" id="MathJax-Span-1247"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-1248"><span class="mrow" id="MathJax-Span-1249"><span class="mi" id="MathJax-Span-1250" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="mi" id="MathJax-Span-1251" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑇<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1252"><span class="mrow" id="MathJax-Span-1253"><span class="mi" id="MathJax-Span-1254" style="font-family: STIXMathJax_Normal-bold;">𝐃</span></span></span><span class="texatom" id="MathJax-Span-1255"><span class="mrow" id="MathJax-Span-1256"><span class="mn" id="MathJax-Span-1257" style="font-family: STIXMathJax_DoubleStruck;">𝟙</span></span></span><span class="mo" id="MathJax-Span-1258" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-1259" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.622em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mi>T</mi></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="double-struck">1</mn></mrow><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-107">\mathbf{z}^T\mathbf{D}\mathbb{1} = 0</script>. It's actually possible to bake this condition into the optimization, by substituting for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1260" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.967em, 1000.42em, 2.801em, -999.997em); top: -2.616em; left: 0em;"><span class="mrow" id="MathJax-Span-1261"><span class="texatom" id="MathJax-Span-1262"><span class="mrow" id="MathJax-Span-1263"><span class="mi" id="MathJax-Span-1264" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.622em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-108">\mathbf{z}</script> the orthogonal complement of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1265" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.967em, 1000.42em, 2.801em, -999.997em); top: -2.616em; left: 0em;"><span class="mrow" id="MathJax-Span-1266"><span class="texatom" id="MathJax-Span-1267"><span class="mrow" id="MathJax-Span-1268"><span class="mi" id="MathJax-Span-1269" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.622em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-109">\mathbf{z}</script> relative to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>D</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;bold&quot;>1</mn></mrow></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1270" style="width: 1.551em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.729em, 1001.19em, 2.801em, -999.997em); top: -2.616em; left: 0em;"><span class="mrow" id="MathJax-Span-1271"><span class="texatom" id="MathJax-Span-1272"><span class="mrow" id="MathJax-Span-1273"><span class="mi" id="MathJax-Span-1274" style="font-family: STIXMathJax_Normal-bold;">𝐃</span></span></span><span class="texatom" id="MathJax-Span-1275"><span class="mrow" id="MathJax-Span-1276"><span class="mn" id="MathJax-Span-1277" style="font-family: STIXMathJax_Main-bold;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.622em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="bold">1</mn></mrow></math></span></span><script type="math/tex" id="MathJax-Element-110">\mathbf{D}\mathbf{1}</script>. In the code below, I define an <code>orth_obj</code> function which handles this for you. </p>
</div>

```python
def orth(u, v):
    return (u @ v) / (v @ v) * v

e = np.ones(n) 

d = D @ e

def orth_obj(z):
    z_o = z - orth(z, d)
    return (z_o @ (D - A) @ z_o)/(z_o @ D @ z_o)
```
```python
import scipy.optimize
z_min = scipy.optimize.minimize(orth_obj,np.random.rand(n)).x
```

## Part E

Recall that, by design, only the sign of `z_min[i]` actually contains information about the cluster label of data point `i`. Plot the original data, using one color for points such that `z_min[i] < 0` and another color for points such that `z_min[i] >= 0`. 


```python

color = (z_min <0)
plt.scatter(X[:,0], X[:,1], c = color)
```
![HW2_5.png](/images/Blog2/HW2_5.png)

<div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><h2 id="Part-F">Part F<a class="anchor-link" href="#Part-F">¶</a></h2>
<p>Explicitly optimizing the orthogonal objective is  <em>way</em> too slow to be practical. If spectral clustering required that we do this each time, no one would use it. </p>
<p>The reason that spectral clustering actually matters, and indeed the reason that spectral clustering is called <em>spectral</em> clustering, is that we can actually solve the problem from Part E using eigenvalues and eigenvectors of matrices. </p>
<p>Recall that what we would like to do is minimize the function </p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>R</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>A</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2261;</mo><mfrac><mrow><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow><mi>T</mi></msup><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>D</mi></mrow><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>A</mi></mrow><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow></mrow><mrow><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow><mi>T</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>D</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow></mrow></mfrac></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-758" style="width: 10.507em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.827em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(0.903em, 1008.83em, 3.484em, -999.997em); top: -2.578em; left: 0em;"><span class="mrow" id="MathJax-Span-759"><span class="msubsup" id="MathJax-Span-760"><span style="display: inline-block; position: relative; width: 1.324em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.72em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="mi" id="MathJax-Span-761" style="font-family: STIXMathJax_Normal-italic;">𝑅</span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -3.899em; left: 0.723em;"><span class="texatom" id="MathJax-Span-762"><span class="mrow" id="MathJax-Span-763"><span class="mi" id="MathJax-Span-764" style="font-size: 70.7%; font-family: STIXMathJax_Normal-bold;">𝐀</span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-765" style="font-family: STIXMathJax_Main;">(</span><span class="texatom" id="MathJax-Span-766"><span class="mrow" id="MathJax-Span-767"><span class="mi" id="MathJax-Span-768" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span><span class="mo" id="MathJax-Span-769" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-770" style="font-family: STIXMathJax_Main; padding-left: 0.303em;">≡</span><span class="mfrac" id="MathJax-Span-771" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 4.865em; height: 0px; margin-right: 0.123em; margin-left: 0.123em;"><span style="position: absolute; clip: rect(3.004em, 1004.68em, 4.385em, -999.997em); top: -4.679em; left: 50%; margin-left: -2.338em;"><span class="mrow" id="MathJax-Span-772"><span class="msubsup" id="MathJax-Span-773"><span style="display: inline-block; position: relative; width: 1.023em; height: 0px;"><span style="position: absolute; clip: rect(3.364em, 1000.42em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="texatom" id="MathJax-Span-774"><span class="mrow" id="MathJax-Span-775"><span class="mi" id="MathJax-Span-776" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -4.379em; left: 0.423em;"><span class="mi" id="MathJax-Span-777" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑇<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-778" style="font-family: STIXMathJax_Main;">(</span><span class="texatom" id="MathJax-Span-779"><span class="mrow" id="MathJax-Span-780"><span class="mi" id="MathJax-Span-781" style="font-family: STIXMathJax_Normal-bold;">𝐃</span></span></span><span class="mo" id="MathJax-Span-782" style="font-family: STIXMathJax_Main; padding-left: 0.243em;">−</span><span class="texatom" id="MathJax-Span-783" style="padding-left: 0.243em;"><span class="mrow" id="MathJax-Span-784"><span class="mi" id="MathJax-Span-785" style="font-family: STIXMathJax_Normal-bold;">𝐀</span></span></span><span class="mo" id="MathJax-Span-786" style="font-family: STIXMathJax_Main;">)</span><span class="texatom" id="MathJax-Span-787"><span class="mrow" id="MathJax-Span-788"><span class="mi" id="MathJax-Span-789" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; clip: rect(3.064em, 1002.16em, 4.205em, -999.997em); top: -3.298em; left: 50%; margin-left: -1.077em;"><span class="mrow" id="MathJax-Span-790"><span class="msubsup" id="MathJax-Span-791"><span style="display: inline-block; position: relative; width: 1.023em; height: 0px;"><span style="position: absolute; clip: rect(3.364em, 1000.42em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="texatom" id="MathJax-Span-792"><span class="mrow" id="MathJax-Span-793"><span class="mi" id="MathJax-Span-794" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -4.319em; left: 0.423em;"><span class="mi" id="MathJax-Span-795" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑇<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="texatom" id="MathJax-Span-796"><span class="mrow" id="MathJax-Span-797"><span class="mi" id="MathJax-Span-798" style="font-family: STIXMathJax_Normal-bold;">𝐃</span></span></span><span class="texatom" id="MathJax-Span-799"><span class="mrow" id="MathJax-Span-800"><span class="mi" id="MathJax-Span-801" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; clip: rect(0.843em, 1004.87em, 1.264em, -999.997em); top: -1.318em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.865em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.083em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.584em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.925em; border-left: 0px solid; width: 0px; height: 2.789em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>R</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">A</mi></mrow></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mo stretchy="false">)</mo><mo>≡</mo><mfrac><mrow><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mi>T</mi></msup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">D</mi></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">A</mi></mrow><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow></mrow><mrow><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mi>T</mi></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-77"> R_\mathbf{A}(\mathbf{z})\equiv \frac{\mathbf{z}^T (\mathbf{D} - \mathbf{A})\mathbf{z}}{\mathbf{z}^T\mathbf{D}\mathbf{z}} </script></p>
<p>with respect to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-802" style="width: 0.543em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.423em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.924em, 1000.42em, 2.764em, -999.997em); top: -2.578em; left: 0em;"><span class="mrow" id="MathJax-Span-803"><span class="texatom" id="MathJax-Span-804"><span class="mrow" id="MathJax-Span-805"><span class="mi" id="MathJax-Span-806" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.584em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-78">\mathbf{z}</script>, subject to the condition <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow><mi>T</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>D</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;double-struck&quot;>1</mn></mrow><mo>=</mo><mn>0</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-807" style="width: 4.805em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.025em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.564em, 1004.02em, 2.764em, -999.997em); top: -2.578em; left: 0em;"><span class="mrow" id="MathJax-Span-808"><span class="msubsup" id="MathJax-Span-809"><span style="display: inline-block; position: relative; width: 1.023em; height: 0px;"><span style="position: absolute; clip: rect(3.364em, 1000.42em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="texatom" id="MathJax-Span-810"><span class="mrow" id="MathJax-Span-811"><span class="mi" id="MathJax-Span-812" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -4.379em; left: 0.423em;"><span class="mi" id="MathJax-Span-813" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑇<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="texatom" id="MathJax-Span-814"><span class="mrow" id="MathJax-Span-815"><span class="mi" id="MathJax-Span-816" style="font-family: STIXMathJax_Normal-bold;">𝐃</span></span></span><span class="texatom" id="MathJax-Span-817"><span class="mrow" id="MathJax-Span-818"><span class="mn" id="MathJax-Span-819" style="font-family: STIXMathJax_DoubleStruck;">𝟙</span></span></span><span class="mo" id="MathJax-Span-820" style="font-family: STIXMathJax_Main; padding-left: 0.303em;">=</span><span class="mn" id="MathJax-Span-821" style="font-family: STIXMathJax_Main; padding-left: 0.303em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.584em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mi>T</mi></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="double-struck">1</mn></mrow><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-79">\mathbf{z}^T\mathbf{D}\mathbb{1} = 0</script>. </p>
<p>The Rayleigh-Ritz Theorem states that the minimizing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-822" style="width: 0.543em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.423em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.924em, 1000.42em, 2.764em, -999.997em); top: -2.578em; left: 0em;"><span class="mrow" id="MathJax-Span-823"><span class="texatom" id="MathJax-Span-824"><span class="mrow" id="MathJax-Span-825"><span class="mi" id="MathJax-Span-826" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.584em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-80">\mathbf{z}</script> must be the solution with smallest eigenvalue of the generalized eigenvalue problem </p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>D</mi></mrow><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>A</mi></mrow><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow><mo>=</mo><mi>&amp;#x03BB;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>D</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow><mspace width=&quot;thickmathspace&quot; /><mo>,</mo><mspace width=&quot;1em&quot; /><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow><mi>T</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>D</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;double-struck&quot;>1</mn></mrow><mo>=</mo><mn>0</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-827" style="width: 14.949em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.548em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.504em, 1012.55em, 2.944em, -999.997em); top: -2.578em; left: 0em;"><span class="mrow" id="MathJax-Span-828"><span class="mo" id="MathJax-Span-829" style="font-family: STIXMathJax_Main;">(</span><span class="texatom" id="MathJax-Span-830"><span class="mrow" id="MathJax-Span-831"><span class="mi" id="MathJax-Span-832" style="font-family: STIXMathJax_Normal-bold;">𝐃</span></span></span><span class="mo" id="MathJax-Span-833" style="font-family: STIXMathJax_Main; padding-left: 0.243em;">−</span><span class="texatom" id="MathJax-Span-834" style="padding-left: 0.243em;"><span class="mrow" id="MathJax-Span-835"><span class="mi" id="MathJax-Span-836" style="font-family: STIXMathJax_Normal-bold;">𝐀</span></span></span><span class="mo" id="MathJax-Span-837" style="font-family: STIXMathJax_Main;">)</span><span class="texatom" id="MathJax-Span-838"><span class="mrow" id="MathJax-Span-839"><span class="mi" id="MathJax-Span-840" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span><span class="mo" id="MathJax-Span-841" style="font-family: STIXMathJax_Main; padding-left: 0.303em;">=</span><span class="mi" id="MathJax-Span-842" style="font-family: STIXMathJax_Normal-italic; padding-left: 0.303em;">𝜆</span><span class="texatom" id="MathJax-Span-843"><span class="mrow" id="MathJax-Span-844"><span class="mi" id="MathJax-Span-845" style="font-family: STIXMathJax_Normal-bold;">𝐃</span></span></span><span class="texatom" id="MathJax-Span-846"><span class="mrow" id="MathJax-Span-847"><span class="mi" id="MathJax-Span-848" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span><span class="mspace" id="MathJax-Span-849" style="height: 0em; vertical-align: 0em; width: 0.303em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-850" style="font-family: STIXMathJax_Main;">,</span><span class="mspace" id="MathJax-Span-851" style="height: 0em; vertical-align: 0em; width: 1.143em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-852" style="padding-left: 0.183em;"><span style="display: inline-block; position: relative; width: 1.023em; height: 0px;"><span style="position: absolute; clip: rect(3.364em, 1000.42em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="texatom" id="MathJax-Span-853"><span class="mrow" id="MathJax-Span-854"><span class="mi" id="MathJax-Span-855" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -4.439em; left: 0.423em;"><span class="mi" id="MathJax-Span-856" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑇<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="texatom" id="MathJax-Span-857"><span class="mrow" id="MathJax-Span-858"><span class="mi" id="MathJax-Span-859" style="font-family: STIXMathJax_Normal-bold;">𝐃</span></span></span><span class="texatom" id="MathJax-Span-860"><span class="mrow" id="MathJax-Span-861"><span class="mn" id="MathJax-Span-862" style="font-family: STIXMathJax_DoubleStruck;">𝟙</span></span></span><span class="mo" id="MathJax-Span-863" style="font-family: STIXMathJax_Main; padding-left: 0.303em;">=</span><span class="mn" id="MathJax-Span-864" style="font-family: STIXMathJax_Main; padding-left: 0.303em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.584em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">D</mi></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">A</mi></mrow><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mo>=</mo><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mspace width="thickmathspace"></mspace><mo>,</mo><mspace width="1em"></mspace><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mi>T</mi></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="double-struck">1</mn></mrow><mo>=</mo><mn>0</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-81"> (\mathbf{D} - \mathbf{A}) \mathbf{z} = \lambda \mathbf{D}\mathbf{z}\;, \quad \mathbf{z}^T\mathbf{D}\mathbb{1} = 0</script></p>
<p>which is equivalent to the standard eigenvalue problem </p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>D</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>D</mi></mrow><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>A</mi></mrow><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow><mo>=</mo><mi>&amp;#x03BB;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow><mspace width=&quot;thickmathspace&quot; /><mo>,</mo><mspace width=&quot;1em&quot; /><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow><mi>T</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;double-struck&quot;>1</mn></mrow><mo>=</mo><mn>0</mn><mspace width=&quot;thickmathspace&quot; /><mo>.</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-865" style="width: 15.849em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.328em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.504em, 1013.27em, 2.944em, -999.997em); top: -2.578em; left: 0em;"><span class="mrow" id="MathJax-Span-866"><span class="msubsup" id="MathJax-Span-867"><span style="display: inline-block; position: relative; width: 1.624em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.66em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="texatom" id="MathJax-Span-868"><span class="mrow" id="MathJax-Span-869"><span class="mi" id="MathJax-Span-870" style="font-family: STIXMathJax_Normal-bold;">𝐃</span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -4.439em; left: 0.723em;"><span class="texatom" id="MathJax-Span-871"><span class="mrow" id="MathJax-Span-872"><span class="mo" id="MathJax-Span-873" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-874" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-875" style="font-family: STIXMathJax_Main;">(</span><span class="texatom" id="MathJax-Span-876"><span class="mrow" id="MathJax-Span-877"><span class="mi" id="MathJax-Span-878" style="font-family: STIXMathJax_Normal-bold;">𝐃</span></span></span><span class="mo" id="MathJax-Span-879" style="font-family: STIXMathJax_Main; padding-left: 0.243em;">−</span><span class="texatom" id="MathJax-Span-880" style="padding-left: 0.243em;"><span class="mrow" id="MathJax-Span-881"><span class="mi" id="MathJax-Span-882" style="font-family: STIXMathJax_Normal-bold;">𝐀</span></span></span><span class="mo" id="MathJax-Span-883" style="font-family: STIXMathJax_Main;">)</span><span class="texatom" id="MathJax-Span-884"><span class="mrow" id="MathJax-Span-885"><span class="mi" id="MathJax-Span-886" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span><span class="mo" id="MathJax-Span-887" style="font-family: STIXMathJax_Main; padding-left: 0.303em;">=</span><span class="mi" id="MathJax-Span-888" style="font-family: STIXMathJax_Normal-italic; padding-left: 0.303em;">𝜆</span><span class="texatom" id="MathJax-Span-889"><span class="mrow" id="MathJax-Span-890"><span class="mi" id="MathJax-Span-891" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span><span class="mspace" id="MathJax-Span-892" style="height: 0em; vertical-align: 0em; width: 0.303em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-893" style="font-family: STIXMathJax_Main;">,</span><span class="mspace" id="MathJax-Span-894" style="height: 0em; vertical-align: 0em; width: 1.143em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-895" style="padding-left: 0.183em;"><span style="display: inline-block; position: relative; width: 1.023em; height: 0px;"><span style="position: absolute; clip: rect(3.364em, 1000.42em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="texatom" id="MathJax-Span-896"><span class="mrow" id="MathJax-Span-897"><span class="mi" id="MathJax-Span-898" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -4.439em; left: 0.423em;"><span class="mi" id="MathJax-Span-899" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑇<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="texatom" id="MathJax-Span-900"><span class="mrow" id="MathJax-Span-901"><span class="mn" id="MathJax-Span-902" style="font-family: STIXMathJax_DoubleStruck;">𝟙</span></span></span><span class="mo" id="MathJax-Span-903" style="font-family: STIXMathJax_Main; padding-left: 0.303em;">=</span><span class="mn" id="MathJax-Span-904" style="font-family: STIXMathJax_Main; padding-left: 0.303em;">0</span><span class="mspace" id="MathJax-Span-905" style="height: 0em; vertical-align: 0em; width: 0.303em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-906" style="font-family: STIXMathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.584em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">D</mi></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">A</mi></mrow><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mo>=</mo><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mspace width="thickmathspace"></mspace><mo>,</mo><mspace width="1em"></mspace><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mi>T</mi></msup><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="double-struck">1</mn></mrow><mo>=</mo><mn>0</mn><mspace width="thickmathspace"></mspace><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-82"> \mathbf{D}^{-1}(\mathbf{D} - \mathbf{A}) \mathbf{z} = \lambda \mathbf{z}\;, \quad \mathbf{z}^T\mathbb{1} = 0\;.</script></p>
<p>Why is this helpful? Well, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;double-struck&quot;>1</mn></mrow></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-907" style="width: 0.663em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.543em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.624em, 1000.36em, 2.704em, -999.997em); top: -2.518em; left: 0em;"><span class="mrow" id="MathJax-Span-908"><span class="texatom" id="MathJax-Span-909"><span class="mrow" id="MathJax-Span-910"><span class="mn" id="MathJax-Span-911" style="font-family: STIXMathJax_DoubleStruck;">𝟙</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.524em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="double-struck">1</mn></mrow></math></span></span><script type="math/tex" id="MathJax-Element-83">\mathbb{1}</script> is actually the eigenvector with smallest eigenvalue of the matrix <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>D</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>D</mi></mrow><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>A</mi></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-912" style="width: 5.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.925em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.504em, 1004.87em, 2.944em, -999.997em); top: -2.578em; left: 0em;"><span class="mrow" id="MathJax-Span-913"><span class="msubsup" id="MathJax-Span-914"><span style="display: inline-block; position: relative; width: 1.624em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.66em, 4.205em, -999.997em); top: -4.019em; left: 0em;"><span class="texatom" id="MathJax-Span-915"><span class="mrow" id="MathJax-Span-916"><span class="mi" id="MathJax-Span-917" style="font-family: STIXMathJax_Normal-bold;">𝐃</span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span><span style="position: absolute; top: -4.439em; left: 0.723em;"><span class="texatom" id="MathJax-Span-918"><span class="mrow" id="MathJax-Span-919"><span class="mo" id="MathJax-Span-920" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-921" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.025em;"></span></span></span></span><span class="mo" id="MathJax-Span-922" style="font-family: STIXMathJax_Main;">(</span><span class="texatom" id="MathJax-Span-923"><span class="mrow" id="MathJax-Span-924"><span class="mi" id="MathJax-Span-925" style="font-family: STIXMathJax_Normal-bold;">𝐃</span></span></span><span class="mo" id="MathJax-Span-926" style="font-family: STIXMathJax_Main; padding-left: 0.243em;">−</span><span class="texatom" id="MathJax-Span-927" style="padding-left: 0.243em;"><span class="mrow" id="MathJax-Span-928"><span class="mi" id="MathJax-Span-929" style="font-family: STIXMathJax_Normal-bold;">𝐀</span></span></span><span class="mo" id="MathJax-Span-930" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.584em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">D</mi></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">A</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-84">\mathbf{D}^{-1}(\mathbf{D} - \mathbf{A})</script>. </p>
<blockquote>
<p>So, the vector <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-931" style="width: 0.543em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.423em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.924em, 1000.42em, 2.764em, -999.997em); top: -2.578em; left: 0em;"><span class="mrow" id="MathJax-Span-932"><span class="texatom" id="MathJax-Span-933"><span class="mrow" id="MathJax-Span-934"><span class="mi" id="MathJax-Span-935" style="font-family: STIXMathJax_Normal-bold;">𝐳</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.584em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-85">\mathbf{z}</script> that we want must be the eigenvector with  the <em>second</em>-smallest eigenvalue. </p>
</blockquote>
</div>

```python
L = np.linalg.inv(D)@(D-A)
Lam, U = np.linalg.eig(L)
ix = Lam.argsort()
Lam, U = Lam[ix], U[:,ix]
z_eig =  U[:,1]
```
```python
plt.scatter(X[:,0], X[:,1], c = np.sign(z_eig))
```
![HW2_6.png](/images/Blog2/HW2_6.png)

## Part G

Synthesize your results from the previous parts. In particular, write a function called `spectral_clustering(X, epsilon)` which takes in the input data `X` (in the same format as Part A) and the distance threshold `epsilon` and performs spectral clustering, returning an array of binary labels indicating whether data point `i` is in group `0` or group `1`. Demonstrate your function using the supplied data from the beginning of the problem. 

There is the things our function will need to do:
1. Construct the similarity matrix. 
2. Construct the Laplacian matrix. 
3. Compute the eigenvector with second-smallest eigenvalue of the Laplacian matrix. 
4. Return labels based on this eigenvector. 


```python
def spectral_clustering(X, epsilon):
    '''
    this function computes the label for spectral clustering
    input: X:  input data
           epsion : distance threshold
    output: an array of binary labels indicating whether data point i is in group 0 or group 1
    '''
    # Construct the similarity matrix A
    n = len(X)
    A = 1*(euclidean_distances(X)< epsilon*np.ones(shape=n))
    np.fill_diagonal(A,0)
    
    # Construct the Laplacian matrix
    D = np.diag(A.sum(axis = 1))
    L = np.linalg.inv(D)@(D-A)
    
    # Compute the eigenvector with second-smallest eigenvalue of the Laplacian matrix.
    Lam, U = np.linalg.eig(L)
    ix = Lam.argsort()
    Lam, U = Lam[ix], U[:,ix]
    z_eig =  U[:,1]
    
    return(1*(z_eig>0))
    
```
```python
spectral_clustering(X, epsilon)
```

```
array([1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1,
       1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0,
       0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0,
       0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0,
       0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1,
       0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0,
       0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1,
       1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0,
       0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0,
       0, 0])
```

```python
plt.scatter(X[:,0], X[:,1], c = spectral_clustering(X, epsilon))
```
![HW2_7.png](/images/Blog2/HW2_7.png)

 
## Part H

```python
X_test, y_test = datasets.make_moons(n_samples=1000, shuffle=True, noise=0.1, random_state=None)
label = spectral_clustering(X_test, epsilon)
plt.scatter(X_test[:,0], X_test[:,1], c = label)
```
![HW2_8.png](/images/Blog2/HW2_8.png)

```python
X_test2, y_test2 = datasets.make_moons(n_samples=1000, shuffle=True, noise=0.2, random_state=None)
label = spectral_clustering(X_test2, epsilon)
plt.scatter(X_test2[:,0], X_test2[:,1], c = label)
```
![HW2_9.png](/images/Blog2/HW2_9.png)

## Part I
Now try your spectral clustering function on another data set -- the bull's eye!

```python
n = 1000
X, y = datasets.make_circles(n_samples=n, shuffle=True, noise=0.05, random_state=None, factor = 0.4)
plt.scatter(X[:,0], X[:,1])
```
![HW2_10.png](/images/Blog2/HW2_10.png)
There are two concentric circles. As before k-means will not do well here at all.
```python
km = KMeans(n_clusters = 2)
km.fit(X)
plt.scatter(X[:,0], X[:,1], c = km.predict(X))
```
![HW2_11.png](/images/Blog2/HW2_11.png)
```python
epsilon = 0.3
label = spectral_clustering(X, epsilon)
plt.scatter(X[:,0], X[:,1], c = label)
```
![HW2_12.png](/images/Blog2/HW2_12.png)
